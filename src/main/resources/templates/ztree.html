<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>    <title>Ztree</title>    <link rel="stylesheet" href="/css/ztree/zTreeStyle.css"/>    <script src="/plugins/jQuery/jquery-2.2.3.min.js"></script>    <script src="/plugins/jQuery/ztree/jquery.ztree.core.js"></script>    <script src="/plugins/jQuery/ztree/jquery.ztree.excheck.js"></script>    <script src="/plugins/jQuery/ztree/jquery.ztree.exedit.js"></script>        <script type="text/javascript">	var setting = {		async: {			enable: true,			url:"/bam/region/regionInfoSearch",			autoParam:["id", "name=n", "level=lv"],			otherParam:{"otherParam":"zTreeAsyncTest"},			dataFilter: filter		},		view: {expandSpeed:"",			addHoverDom: addHoverDom,			removeHoverDom: removeHoverDom,			selectedMulti: false		},		edit: {			enable: true		},		data: {			simpleData: {				enable: true			}		},		callback: {			beforeRemove: beforeRemove,			beforeRename: beforeRename		}	};	function filter(treeId, parentNode, childNodes) {		if (!childNodes) return null;		for (var i=0, l=childNodes.length; i<l; i++) {					childNodes[i].name = childNodes[i].name.replace(/\.n/g, '.');		}		return childNodes;	}	function beforeRemove(treeId, treeNode) {		var zTree = $.fn.zTree.getZTreeObj("treeDemo");		zTree.selectNode(treeNode);		var flag=confirm("确认删除 节点 -- " + treeNode.name + " 吗？");		if(flag==true){			$.ajax({	            url: "/bam/region/delRegionInfo",	            contentType: "application/x-www-form-urlencoded; charset=utf-8",	            data:{id:treeNode.id},	            dataType: "json",	            type: "POST",	            success : function(data)	            {	                if(data.success)	                {    	                	return true;	                }else{	                	alert("删除失败");	                	return false;	                }	            }	        });		}else{			return false;		}			}			function beforeRename(treeId, treeNode, newName) {		if (newName.length == 0) {			setTimeout(function() {				var zTree = $.fn.zTree.getZTreeObj("treeDemo");				zTree.cancelEditName();				alert("节点名称不能为空.");			}, 0);			return false;		}		$.ajax({            url: "/bam/region/editRegionInfo",            contentType: "application/x-www-form-urlencoded; charset=utf-8",            data:{id:treeNode.id,name:newName},            dataType: "json",            type: "POST",            success : function(data)            {                if(data.success)                {                   	return true;                }else{                	alert("修改失败");                	return false;                }            }        });				return true;	}	var newCount = 1;	function addHoverDom(treeId, treeNode) {		var sObj = $("#" + treeNode.tId + "_span");		if (treeNode.editNameFlag || $("#addBtn_"+treeNode.tId).length>0) return;		var addStr = "<span class='button add' id='addBtn_" + treeNode.tId+ "' title='add node' onfocus='this.blur();'></span>";		sObj.after(addStr);		var btn = $("#addBtn_"+treeNode.tId);		if (btn) btn.bind("click", function(){			var zTree = $.fn.zTree.getZTreeObj("treeDemo");			var str=prompt("输入地区");			if(str)			{				$.ajax({		            url: "/bam/region/addRegionInfo",		            contentType: "application/x-www-form-urlencoded; charset=utf-8",		            data:{pid:treeNode.id,name:str},		            dataType: "json",		            type: "POST",		            success : function(data)		            {		                if(data.success)		                {   		                	 type = "refresh",  		                     silent = false,  		                    /*获取 zTree 当前被选中的节点数据集合*/  		                   /// nodes = zTree.getSelectedNodes();  		                    /*强行异步加载父节点的子节点。[setting.async.enable = true 时有效]*/  		                    myNode=zTree.getNodeByTId(treeNode.tId);		                    myNode.isParent=true		                    zTree.reAsyncChildNodes(myNode, type, silent);  		                	return true;		                }else{		                	alert("修改失败");		                	return false;		                }		            }		        });			}			//zTree.addNodes(treeNode, {id:(100 + newCount), pId:treeNode.id, name:"new node" + (newCount++)});			return false;		});	};	function removeHoverDom(treeId, treeNode) {		$("#addBtn_"+treeNode.tId).unbind().remove();	};	$(document).ready(function(){		$.fn.zTree.init($("#treeDemo"), setting);	});	    </script></head><body>    <div>		<ul id="treeDemo" class="ztree"></ul>	</div></body></html>